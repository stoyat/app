!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){$=a("jquery"),Backbone=a("backbone"),Backbone.$=a("jquery"),_=a("underscore"),Marionette=a("backbone.marionette"),Marionette.Renderer.render=function(a,b){return Templates[a](b)},Loading={show:function(){$("#loading").show()},hide:function(){$("#loading").hide()}},App=new Marionette.Application,App.addRegions({content:"#content",menu:"#menu-container"}),App.addInitializer(function(){App.AppRouter=a("./Router"),Backbone.history.start()}),$(document).ready(function(){App.start()})},{"./Router":9,backbone:"backbone","backbone.marionette":"backbone.marionette",jquery:"jquery",underscore:"underscore"}],2:[function(a,b,c){b.exports={index:function(){var b=a("./views/WelcomeView");App.content.show(new b)},books:function(){Loading.show();var b=a("./models/BookCollection"),c=new b;c.fetch({success:function(b){var c=a("./views/books/BooksTbView");App.content.show(new c({collection:b})),Loading.hide()}})},book:function(b){Loading.show();var c=a("./models/BookModel"),d=new c({id:b});d.fetch({success:function(b){var c=a("./views/books/BookDetailView");App.content.show(new c({model:b})),Loading.hide()}})},book_edit:function(b){Loading.show();var c=a("./models/BookModel"),d=new c({id:b});d.fetch({success:function(b){var c=a("./views/books/BookEditView");App.content.show(new c({model:b})),Loading.hide()}})},book_delete:function(b){Loading.show();var c=a("./models/BookModel"),d=new c({id:b});d.destroy({success:function(){Backbone.history.navigate("/books",{trigger:!0})}})},book_add:function(){var b=a("./models/BookModel"),c=new b,d=a("./views/books/BookEditView");App.content.show(new d({model:c}))},register:function(){Loading.show();var b=a("./models/RegisterCollection"),c=new b;c.fetch({success:function(b){var c=a("./views/register/RegisterTbView");App.content.show(new c({collection:b})),Loading.hide()}})},register_delete:function(b){Loading.show();var c=a("./models/RegisterModel"),d=new c({id:b});d.destroy({success:function(){Backbone.history.navigate("/bookregister",{trigger:!0})}})},register_create:function(){Loading.show();var b=a("./models/BookCollection"),c=a("./models/UserCollection"),d=new b,e=new c;d.fetch({success:function(b){e.fetch({success:function(c){var d=a("./views/register/RegisterAttachView");App.content.show(new d({booksCollection:b,usersCollection:c})),Loading.hide()}})}})},users:function(){Loading.show();var b=a("./models/UserCollection"),c=new b;c.fetch({success:function(b){var c=a("./views/users/UsersTbView");App.content.show(new c({collection:b})),Loading.hide()}})},user:function(b){Loading.show();var c=a("./models/UserModel"),d=new c({id:b});d.fetch({success:function(b){var c=a("./views/users/UserDetailView");App.content.show(new c({model:b,collection:new Backbone.Collection(b.attributes.books)})),Loading.hide()}})},user_book_delete:function(b){Loading.show();var c=a("./models/RegisterModel"),d=new c({id:b});d.destroy({success:function(){Backbone.history.history.back()}})}}},{"./models/BookCollection":3,"./models/BookModel":4,"./models/RegisterCollection":5,"./models/RegisterModel":6,"./models/UserCollection":7,"./models/UserModel":8,"./views/WelcomeView":10,"./views/books/BookDetailView":11,"./views/books/BookEditView":12,"./views/books/BooksTbView":14,"./views/register/RegisterAttachView":15,"./views/register/RegisterTbView":18,"./views/users/UserDetailView":23,"./views/users/UsersTbView":25}],3:[function(a,b,c){b.exports=Backbone.Collection.extend({url:"/api/books",model:a("./BookModel")})},{"./BookModel":4}],4:[function(a,b,c){b.exports=Backbone.Model.extend({urlRoot:"/api/books",defaults:{title:"",author:"",year:"",genre:""},validate:function(a,b){var c=/^[a-zA-Z][a-zA-Z \.]{5,}$/;if(!c.test(a.title))return"Incorrect title";if(!c.test(a.author))return"Incorrect author";if(!/^[a-zA-Z][a-zA-Z \.]{3,}$/.test(a.genre))return"Incorrect genre";var d=new Date;return Number(a.year)<d.getFullYear()?void 0:"Incorrect year"}})},{}],5:[function(a,b,c){b.exports=Backbone.Collection.extend({url:"/api/userbook",model:a("./RegisterModel")})},{"./RegisterModel":6}],6:[function(a,b,c){b.exports=Backbone.Model.extend({urlRoot:"/api/userbook"})},{}],7:[function(a,b,c){b.exports=Backbone.Collection.extend({url:"/api/users",model:a("./UserModel")})},{"./UserModel":8}],8:[function(a,b,c){b.exports=Backbone.Model.extend({urlRoot:"/api/users",validate:function(a,b){if(!/([A-z]{6,})/.test(a.firstname))return"Incorrect firstname";if(!/([A-z]{6,})/.test(a.lastname))return"Incorrect lastname";var c=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return c.test(a.email)?void 0:"Incorrect email"}})},{}],9:[function(a,b,c){b.exports=new Marionette.AppRouter({controller:a("./controller"),appRoutes:{"":"index","books/create":"book_add",books:"books","books/:id":"book","books/:id/edit":"book_edit","books/:id/delete":"book_delete",users:"users","users/:id":"user","userbook/:id/delete":"user_book_delete","bookregister/create":"register_create","bookregister/:id/delete":"register_delete",bookregister:"register"}})},{"./controller":2}],10:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"welcome"})},{}],11:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"books/Detail",tagName:"div",className:"row"})},{}],12:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"books/Edit",tagName:"form",events:{submit:"submitForm"},submitForm:function(a){a.preventDefault();var b=this.model,c=this.$el.serializeArray(),d=_(c).reduce(function(a,c){b.set(c.name,c.value)},{});return b.isValid()?(Loading.show(),void b.save(d,{success:function(){Backbone.history.navigate("/books",{trigger:!0})}})):void alert(b.validationError)}})},{}],13:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"books/TbItem",tagName:"tr"})},{}],14:[function(a,b,c){b.exports=Marionette.CompositeView.extend({tagName:"table",className:"table table-responsive table-hover table-bordered",template:"books/Tb",childView:a("./BooksTbItem"),childViewContainer:"tbody"})},{"./BooksTbItem":13}],15:[function(a,b,c){b.exports=Marionette.LayoutView.extend({events:{submit:"submitForm"},submitForm:function(b){b.preventDefault();var c=this.$el.serializeArray(),d=_(c).reduce(function(a,b){return a[b.name]=b.value,a},{}),e=a("./../../models/RegisterModel"),f=new e;f.save(d,{success:function(){Backbone.history.navigate("/users/"+d.user_id,{trigger:!0})}})},template:"register/Attach",tagName:"form",regions:{users:"#users",books:"#books"},onRender:function(){var b=a("./RegisterBooksSelector");this.showChildView("books",new b({collection:this.options.booksCollection}));var c=a("./RegisterUsersSelector");this.showChildView("users",new c({collection:this.options.usersCollection}))}})},{"./../../models/RegisterModel":6,"./RegisterBooksSelector":16,"./RegisterUsersSelector":19}],16:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"register/AttachBooksSelector",tagName:"select",className:"form-control",attributes:{name:"book_id"}})},{}],17:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"register/TbItem",tagName:"tr"})},{}],18:[function(a,b,c){b.exports=Marionette.CompositeView.extend({tagName:"table",className:"table table-responsive table-hover table-bordered",template:"register/Tb",childView:a("./RegisterTbItem"),childViewContainer:"tbody"})},{"./RegisterTbItem":17}],19:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"register/AttachUsersSelector",tagName:"select",className:"form-control",attributes:{name:"user_id"}})},{}],20:[function(a,b,c){b.exports=Marionette.CompositeView.extend({tagName:"table",className:"table table-responsive table-hover table-bordered",template:"books/Tb",childView:a("./UserDetailBooksTbItem"),childViewContainer:"tbody"})},{"./UserDetailBooksTbItem":21}],21:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"users/BooksTbItem",tagName:"tr"})},{}],22:[function(a,b,c){b.exports=Marionette.ItemView.extend({tagName:"div",className:"col-md-12",template:"users/DetailInfo"})},{}],23:[function(a,b,c){b.exports=Marionette.LayoutView.extend({template:"users/Detail",tagName:"div",className:"row",regions:{user:"#user",books:"#books"},onRender:function(){var b=a("./../../views/users/UserDetailBooksTb");this.showChildView("books",new b({collection:this.collection}));var c=a("./../../views/users/UserDetailInfo");this.showChildView("user",new c({model:this.model}))}})},{"./../../views/users/UserDetailBooksTb":20,"./../../views/users/UserDetailInfo":22}],24:[function(a,b,c){b.exports=Marionette.ItemView.extend({template:"users/TbItem",tagName:"tr"})},{}],25:[function(a,b,c){b.exports=Marionette.CompositeView.extend({tagName:"table",className:"table table-responsive table-hover table-bordered",template:"users/Tb",childView:a("./UsersTbItemView"),childViewContainer:"tbody"})},{"./UsersTbItemView":24}]},{},[1]);